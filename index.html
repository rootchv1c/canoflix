<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CanoFlix - VIP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --red: #E50914; --black: #0f0f0f; --gray: #1a1a1a; }
        body { background: var(--black); color: white; font-family: sans-serif; }
        
        .header { position: fixed; top: 0; width: 100%; background: rgba(0,0,0,0.9); z-index: 1000; padding: 15px; border-bottom: 1px solid #333; text-align: center; }
        .logo { color: var(--red); font-size: 2rem; font-weight: bold; margin-bottom: 15px; display: block; text-decoration: none; }
        
        .nav-buttons { display: flex; gap: 10px; justify-content: center; overflow-x: auto; padding-bottom: 10px; }
        .nav-buttons button { background: var(--gray); color: white; border: 2px solid transparent; padding: 10px 20px; border-radius: 20px; cursor: pointer; white-space: nowrap; transition: 0.3s; }
        .nav-buttons button.active { border-color: var(--red); background: var(--red); }

        .search-box { width: 90%; max-width: 500px; padding: 10px; margin: 10px auto; display: block; border-radius: 5px; border: none; background: #222; color: white; }

        .content-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; padding: 180px 5% 20px; }
        .card { background: var(--gray); border-radius: 8px; overflow: hidden; cursor: pointer; transition: 0.3s; position: relative; }
        .card:hover { transform: scale(1.05); }
        .card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; background: #333; }
        .card-name { padding: 10px; font-size: 0.8rem; text-align: center; height: 50px; overflow: hidden; }
        
        #loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none; color: var(--red); font-weight: bold; z-index: 3000; }
        
        /* Player Modal */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 4000; display: none; }
        .close-btn { position: absolute; top: 20px; right: 20px; color: white; font-size: 30px; cursor: pointer; z-index: 4001; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

    <div class="header">
        <a href="#" class="logo">CANOFLIX</a>
        <div class="nav-buttons">
            <button onclick="changeCategory('canli.m3u', this)" class="active">üì∫ Canlƒ± TV</button>
            <button onclick="changeCategory('film.m3u', this)">üé¨ Filmler</button>
            <button onclick="changeCategory('dizi.m3u', this)">üéûÔ∏è Diziler</button>
            <button onclick="changeCategory('spor.m3u', this)">‚öΩ Spor</button>
        </div>
        <input type="text" id="search" class="search-box" placeholder="ƒ∞√ßerik ara...">
    </div>

    <div id="loading">üìä Y√ºkleniyor, bekleyin kanka...</div>
    <div class="content-grid" id="grid"></div>

    <div id="playerModal" class="modal">
        <span class="close-btn" onclick="closePlayer()">&times;</span>
        <div id="playerContainer" style="width:100%; height:100%;"></div>
    </div>

    <script>
        let allItems = [];
        let currentFile = 'canli.m3u';

        async function loadData(fileName) {
            const grid = document.getElementById('grid');
            const loader = document.getElementById('loading');
            
            grid.innerHTML = '';
            loader.style.display = 'block';
            
            try {
                // GitHub √ºzerinden dosyayƒ± √ßek (Cache √∂nlemek i√ßin timestamp ekledik)
                const resp = await fetch(fileName + '?v=' + Date.now());
                const text = await resp.text();
                
                const lines = text.split('\n');
                allItems = [];
                let currentItem = {};

                for(let line of lines) {
                    line = line.trim();
                    if(line.startsWith('#EXTINF:')) {
                        const name = line.split(',')[1] || "ƒ∞simsiz ƒ∞√ßerik";
                        const logo = line.match(/tvg-logo="([^"]+)"/)?.[1] || "";
                        currentItem = { name, logo };
                    } else if(line.startsWith('http')) {
                        currentItem.url = line;
                        allItems.push(currentItem);
                        currentItem = {};
                    }
                }
                render(allItems);
            } catch (err) {
                console.error("Y√ºkleme hatasƒ±:", err);
                grid.innerHTML = `<p style="text-align:center">Dosya bulunamadƒ±: ${fileName}</p>`;
            }
            loader.style.display = 'none';
        }

        function render(data) {
            const grid = document.getElementById('grid');
            grid.innerHTML = data.slice(0, 100).map(item => `
                <div class="card" onclick="play('${item.url}')">
                    <img src="${item.logo}" onerror="this.src='https://via.placeholder.com/200x300?text=No+Image'">
                    <div class="card-name">${item.name}</div>
                </div>
            `).join('');
        }

        function changeCategory(file, btn) {
            document.querySelectorAll('.nav-buttons button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadData(file);
        }

        function play(url) {
            const modal = document.getElementById('playerModal');
            const container = document.getElementById('playerContainer');
            modal.style.display = 'block';
            
            // Player tipi (HLS player linki veya direkt iframe)
            // Kanka buraya kendi player linkini de koyabilirsin
            container.innerHTML = `<iframe src="${url}" allowfullscreen></iframe>`;
        }

        function closePlayer() {
            document.getElementById('playerModal').style.display = 'none';
            document.getElementById('playerContainer').innerHTML = '';
        }

        // Arama Motoru
        document.getElementById('search').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = allItems.filter(i => i.name.toLowerCase().includes(term));
            render(filtered);
        });

        // Sayfa a√ßƒ±lƒ±≈üƒ±nda canlƒ± TV'yi y√ºkle
        window.onload = () => loadData('canli.m3u');
    </script>
</body>
</html>
